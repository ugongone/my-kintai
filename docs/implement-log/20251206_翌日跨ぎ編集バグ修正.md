## 概要

月次実績ページのインライン編集で、翌日跨ぎ勤務（例：09:15〜翌00:30）を編集・保存すると、実働時間が異常な値（79:28など）になるバグを修正。

## 実装内容

### 原因

`replaceEntriesForDate` 関数が `work_date` でエントリを削除する際、翌日跨ぎ勤務の `work_end` エントリ（翌日の `work_date` を持つ）が削除されずに残っていた。

結果として古い `work_end` と新しい `work_end` が両方存在し、計算時に異常な実働時間が算出された。

### 修正内容

日付ベースの削除ではなく、エントリIDベースの削除に変更。

**変更ファイル:**
- [src/hooks/useTimeEntries.ts](../../src/hooks/useTimeEntries.ts) - `entryIds` パラメータを追加、IDで削除
- [src/components/history/EditEntryRow.tsx](../../src/components/history/EditEntryRow.tsx) - 保存時に `stat.entries` のIDを渡す
- [src/components/history/HistoryTable.tsx](../../src/components/history/HistoryTable.tsx) - 型定義を更新
- [src/app/(authenticated)/history/page.tsx](../../src/app/(authenticated)/history/page.tsx) - 型定義を更新

**修正後のコード（useTimeEntries.ts）:**
```typescript
const replaceEntriesForDate = async (data: {
  // ...
  entryIds?: string[]
}) => {
  // 既存エントリを削除（IDが指定されていればIDで、なければwork_dateで削除）
  const { error: deleteError } = data.entryIds && data.entryIds.length > 0
    ? await supabase
        .from('time_entries')
        .delete()
        .eq('user_id', user.id)
        .in('id', data.entryIds)
    : await supabase
        .from('time_entries')
        .delete()
        .eq('user_id', user.id)
        .eq('work_date', data.date)
  // ...
}
```

## Q&A

### Q1: なぜIDベースの削除に変更したのか？

日付ベースの削除では以下の問題があった：
- 翌日跨ぎ勤務の `work_end`（翌日の `work_date` を持つ）が削除されない
- 翌日の `work_date` も削除対象にすると、翌日の別の勤務まで削除されてしまう

`stat.entries` には編集対象の勤務セッションに属する全エントリ（翌日の `work_end` を含む）が既に含まれているため、そのIDを使えば正確にそのセッションのみ削除できる。

### Q2: `entryIds` がない場合のフォールバックは必要？

後方互換性のため、`entryIds` が指定されていない場合は従来の `work_date` ベースで削除する。これにより既存の呼び出し箇所に影響を与えない。

### Q3: `stat.entries` には翌日のエントリも含まれているのか？

はい。`calculateDailyStats` 関数が勤務セッションを構築する際、`work_start` から `work_end` までの関連エントリを全て同一セッションとして扱う。そのため翌日の `work_end` も `stat.entries` に含まれる。
